<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:g="http://www.backbase.com/2008/gadget"
      xml:lang="en-US">
<head>
  <title>BB Retail-Banking Page - with 5.6.x Compatibility :: Standalone</title>
  <meta http-equiv="Content-Type" content="text/xml; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <link href="/node_modules/theme-bb-default/styles/theme-bb-default.css" rel="stylesheet" />
  <script src="/node_modules/backbase-widget-engine/dist/portal-kit.js"></script>
  <!-- CXP 5.6.x shims-->
  <script src="/node_modules/portal5-support/portal5-client-shim.js"></script>
</head>

<body class="container">
  <div id="widget-root"><!-- WIDGET src --></div>
  <script>
    (function(window, doc, undefined) {
      'use strict';

      // get base path
      var getLocation = function(href) {
          var l = document.createElement("a");
          l.href = href;
          return l;
      };

      var location = getLocation(window.location.href);
      var contextRoot = location.protocol + '//' + location.host;
      var widgetName = location.pathname.replace(/\/([^\/]+)(\/.*)?/, '$1');
      
      //setup a widget engine
      window.setupPortalShim && window.setupPortalShim(window, {
            // custom config here
            portalName: 'Standalone development',
            contextRoot: contextRoot
      });

      var widgetEngine = new portalKit.WidgetEngine({
          logLevel: 'silent'
      });

      var widgetUrl = contextRoot + '/static/widgets/[BBHOST]/' + widgetName;
      widgetEngine.init({
          widgetUrl: widgetUrl,
          widgetEl: document.getElementById('widget-root'),
          configFile: 'model.xml',
          configVars: {
              contextRoot: contextRoot
          },
          parser: new portalKit.AutoConfigParser(),
          reader: new portalKit.XhrWidgetReader({
              noCache: true
          })
      });

      widgetEngine.addPlugin(new portalKit.ReplaceConfigVarsPlugin({
          servicesPath: '',
          itemRoot: widgetUrl
      }, {
          full: true
      }));

      //By default add the backbase format plugin
      widgetEngine.addPlugin(new portalKit.BackbaseFormatPlugin({
          storage: widgetEngine.widgetEngine.config.storage,
          makeIncludedRefsAbsolute: true,
          portalConf: {
              contextItemName: 'standalone-demo'
          }
      }));

      //start it up
      widgetEngine.start();
    }(window, document, undefined));
  </script>
  <!-- CXP 5.6.x libs-->
  <script src="/node_modules/portal5-support/compatibility.js"></script>
</body>
</html>
