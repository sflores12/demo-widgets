{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6**","webpack:///webpack/bootstrap ba9372d13c966203e28a?ccfa**","webpack:///./model-bb-income-spending-analysis-category-ng/model.xml","webpack:///./model-bb-income-spending-analysis-category-ng/scripts/index.js","webpack:///external \"vendor-bb-angular\"","webpack:///external \"data-bb-transactions-http-ng\"","webpack:///external \"data-bb-product-summary-http-ng\"","webpack:///external \"lib-bb-storage-ng\"","webpack:///external \"lib-bb-widget-ng\"","webpack:///./model-bb-income-spending-analysis-category-ng/scripts/income-spending-analysis-category.js","webpack:///external \"lib-bb-model-errors\"","webpack:///./model-bb-income-spending-analysis-category-ng/scripts/constants.js"],"names":["moduleKey","modelIncomeSpendingAnalysisCategoryKey","module","factory","name","analysisCategoryModel","Promise","incomeSpendingData","productSummaryData","bbStorage","widgetInstance","FROM_STORAGE","getBooleanPreference","IS_PRODUCTS_LIST_FROM_STORAGE","GET_FIRST_AS_DEFAULT","IS_FIRST_PRODUCT_DEFAULT","IS_MULTIPLE_ACCOUNTS","productKindHasProducts","productKind","products","length","validateAnalysisParameters","params","creditDebitIndicator","arrangementIds","Array","isArray","periodStartDate","periodEndDate","resolve","reject","code","loadAnalysisData","getTransactionsCategorytotals","then","response","data","catch","e","loadProducts","getProductsummary","setItem","PRODUCT_SUMMARY","getProducts","getItem","getProductsArray","keepEmptyProducts","Object","keys","filter","kind","reduce","extendedProducts","map","assign","product","concat","getProductByID","productId","defaultProduct","find","id","getProductsFromList","ids","push","getSelectedProduct","PRODUCT_SELECTED","getSelectedProducts","PRODUCTS_SELECTED","setSelectedProduct","selectedProduct","removeItem","setSelectedProducts","transformToSeries","analysisCategoryData","items","sort","a","b","portion","datasets","item","labels","category","isFirstProductDefault","isMultipleAccount","E_PARAMS","bbStorageKeys","preferencesKeys"],"mappings":"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","file":"model-bb-income-spending-analysis-category-ng/scripts/model-bb-income-spending-analysis-category-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vendor-bb-angular\"), require(\"data-bb-transactions-http-ng\"), require(\"data-bb-product-summary-http-ng\"), require(\"lib-bb-storage-ng\"), require(\"lib-bb-widget-ng\"), require(\"lib-bb-model-errors\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"model-bb-income-spending-analysis-category-ng\", [\"vendor-bb-angular\", \"data-bb-transactions-http-ng\", \"data-bb-product-summary-http-ng\", \"lib-bb-storage-ng\", \"lib-bb-widget-ng\", \"lib-bb-model-errors\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"model-bb-income-spending-analysis-category-ng\"] = factory(require(\"vendor-bb-angular\"), require(\"data-bb-transactions-http-ng\"), require(\"data-bb-product-summary-http-ng\"), require(\"lib-bb-storage-ng\"), require(\"lib-bb-widget-ng\"), require(\"lib-bb-model-errors\"));\n\telse\n\t\troot[\"model-bb-income-spending-analysis-category-ng\"] = factory(root[\"vendor-bb-angular\"], root[\"data-bb-transactions-http-ng\"], root[\"data-bb-product-summary-http-ng\"], root[\"lib-bb-storage-ng\"], root[\"lib-bb-widget-ng\"], root[\"lib-bb-model-errors\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_22__, __WEBPACK_EXTERNAL_MODULE_23__, __WEBPACK_EXTERNAL_MODULE_24__, __WEBPACK_EXTERNAL_MODULE_25__, __WEBPACK_EXTERNAL_MODULE_26__, __WEBPACK_EXTERNAL_MODULE_28__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ba9372d13c966203e28a","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model-bb-income-spending-analysis-category-ng/model.xml\n// module id = 0\n// module chunks = 3","/**\n * @module model-bb-income-spending-analysis-category-ng\n *\n * @description\n * Model for widget-bb-income-spending-analysis-category-ng\n *\n * @example\n * import modelIncomeSpendingAnalysisCategoryModuleKey, {\n *  modelIncomeSpendingAnalysisCategoryKey\n * } from 'model-bb-income-spending-analysis-category-ng';\n *\n * angular\n *   .module('ExampleModule', [\n *     modelAnalysisCategoryModuleKey,\n *   ])\n *   .factory('someFactory', [\n *     modelAnalysisCategoryKey,\n *     // into\n *     function someFactory(analysisCategoryModel) {\n *       // ...\n *     },\n *   ]);\n */\nimport angular from 'vendor-bb-angular';\n\nimport transactionsDataModuleKey, {\n  transactionsDataKey,\n} from 'data-bb-transactions-http-ng';\n\nimport productSummaryDataModuleKey, {\n  productSummaryDataKey,\n} from 'data-bb-product-summary-http-ng';\n\nimport bbStorageModuleKey, {\n  bbStorageServiceKey,\n} from 'lib-bb-storage-ng';\n\nimport widgetModuleKey, {\n  widgetKey,\n} from 'lib-bb-widget-ng';\n\nimport Model from './income-spending-analysis-category';\n\nconst moduleKey = 'model-bb-income-spending-analysis-category-ng';\nexport const modelIncomeSpendingAnalysisCategoryKey = `${moduleKey}:model`;\n\nexport default angular\n  .module(moduleKey, [\n    transactionsDataModuleKey,\n    productSummaryDataModuleKey,\n    bbStorageModuleKey,\n    widgetModuleKey,\n  ])\n\n  .factory(modelIncomeSpendingAnalysisCategoryKey, [\n    '$q',\n    transactionsDataKey,\n    productSummaryDataKey,\n    bbStorageServiceKey,\n    widgetKey,\n    /* into */\n    Model,\n  ])\n\n  .name;\n\n/**\n * Amount object\n * @typedef {object} Amount\n * @property {string} currencyCode Currency code (ISO)\n * @property {number} value\n */\n\n/**\n * Income/Spending analysis category response object\n * @typedef {object} AnalysisCategoryData\n * @property {Amount} total Total amount for all categories retrieved for selected period\n * @property {AnalysisCategory[]} items Array of income/spending items\n */\n\n/**\n * Income/Spending category item\n * @typedef {object} AnalysisCategory\n * @property {string} category Transactions category\n * @property {Amount} totalAmount Total amount of aggregated transactions by category\n * @property {number} trend Percentage value of the trend\n * @property {number} portion Percentage of the total amount for a given period\n */\n\n/**\n * BBSeries data object used to draw charts\n * @typedef {object} BBSeries\n * @property {string[]} labels Array of x axis labels\n * @property {Dataset[]} datasets Array of all y axis value datasets\n */\n\n/**\n * Dataset object for y axis data\n * @typedef {object} Dataset\n * @property {number[]} data Array of data points to be drawn for each label\n */\n\n\n\n// WEBPACK FOOTER //\n// ./model-bb-income-spending-analysis-category-ng/scripts/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_22__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor-bb-angular\"\n// module id = 22\n// module chunks = 3 4 5 6 7","module.exports = __WEBPACK_EXTERNAL_MODULE_23__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"data-bb-transactions-http-ng\"\n// module id = 23\n// module chunks = 3 4","module.exports = __WEBPACK_EXTERNAL_MODULE_24__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"data-bb-product-summary-http-ng\"\n// module id = 24\n// module chunks = 3 4","module.exports = __WEBPACK_EXTERNAL_MODULE_25__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-storage-ng\"\n// module id = 25\n// module chunks = 3 4","module.exports = __WEBPACK_EXTERNAL_MODULE_26__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-ng\"\n// module id = 26\n// module chunks = 3 4 6 7","/* eslint max-len: [\"error\", 100, { \"ignoreComments\": true }]*/\nimport { fromHttpError } from 'lib-bb-model-errors';\nimport { bbStorageKeys, preferencesKeys, E_PARAMS } from './constants';\n\n/**\n * Model factory for model-bb-income-spending-analysis-category-ng\n *\n * @inner\n * @type {function}\n * @param {Object} Promise An ES2015 compatible `Promise` object.\n *\n * @return {Object}\n */\nexport default function analysisCategoryModel(\n  Promise,\n  incomeSpendingData,\n  productSummaryData,\n  bbStorage,\n  widgetInstance\n) {\n  /**\n   * @name analysisCategoryModel#FROM_STORAGE\n   * @inner\n   * @type {boolean}\n   *\n   * @description\n   * Defines if products are recieved from bb-storage or from API always\n   */\n  const FROM_STORAGE = widgetInstance.getBooleanPreference(\n    preferencesKeys.IS_PRODUCTS_LIST_FROM_STORAGE\n  );\n\n  /**\n   * @name analysisCategoryModel#GET_FIRST_AS_DEFAULT\n   * @inner\n   * @type {boolean}\n   *\n   * @description\n   * Defines if the first product is selected by default\n   */\n  const GET_FIRST_AS_DEFAULT = widgetInstance.getBooleanPreference(\n    preferencesKeys.IS_FIRST_PRODUCT_DEFAULT\n  );\n\n  /**\n   * @name analysisCategoryModel#IS_MULTIPLE_ACCOUNTS\n   * @inner\n   * @type {boolean}\n   *\n   * @description\n   * Defines if the widget is combined with multiple account selector\n   */\n  const IS_MULTIPLE_ACCOUNTS = widgetInstance.getBooleanPreference(\n    preferencesKeys.IS_MULTIPLE_ACCOUNTS\n  );\n\n  /**\n   * @name analysisCategoryModel#productKindHasProducts\n   * @inner\n   * @type {function}\n   *\n   * @description\n   * Checks if product kind has any products\n   *\n   * @param {module:model-bb-product-summary-ng.ProductKind} productKind Product kind object\n   * @return {boolean} Has at least one product products\n   */\n  const productKindHasProducts = productKind => productKind.products && productKind.products.length;\n\n  /**\n   * @name analysisCategoryModel#validateAnalysisParameters\n   * @type {function}\n   *\n   * @description\n   * Checks if all required parameters are set\n   *\n   * @param {object} params\n   * @returns {Promise.<object>}\n   * A Promise resolving to object with parameters.\n   */\n  const validateAnalysisParameters = (params) => {\n    if (params.creditDebitIndicator\n      && params.arrangementIds && Array.isArray(params.arrangementIds)\n      && params.periodStartDate\n      && params.periodEndDate\n    ) {\n      return Promise.resolve(params);\n    }\n\n    return Promise.reject({\n      code: E_PARAMS,\n    });\n  };\n\n  /**\n   * @name analysisCategoryModel#loadAnalysisData\n   * @type {function}\n   *\n   * @description\n   * Load income/spending analysis data by category\n   *\n   * @param {object} params Request parameters\n   * @returns {Promise.<AnalysisCategoryData, module:lib-bb-model-errors.ModelError>} A Promise with spending or error data\n   */\n  const loadAnalysisData = (params) => incomeSpendingData.getTransactionsCategorytotals(params)\n    .then(response => response.data)\n    .catch(e => {\n      throw fromHttpError(e);\n    });\n\n  /**\n   * @name analysisCategoryModel#loadProducts\n   * @inner\n   * @type {function}\n   *\n   * @description\n   * Load products from API.\n   *\n   * @returns {Promise.<module:model-bb-product-summary-ng.ProductKinds, module:lib-bb-model-errors.ModelError>}\n   * A Promise resolving to object with ProductsKinds and TotalBalance.\n   */\n  const loadProducts = () => productSummaryData\n    .getProductsummary()\n    .then(({ data }) => {\n      bbStorage.setItem(bbStorageKeys.PRODUCT_SUMMARY, data);\n      return data;\n    })\n    .catch((e) => {\n      throw fromHttpError(e);\n    });\n\n  /**\n   * @name analysisCategoryModel#getProducts\n   * @type {function}\n   *\n   * @description\n   * Get products either from storage or from the service\n   *\n   * @returns {Promise.<module:model-bb-product-summary-ng.ProductKinds, module:lib-bb-model-errors.ModelError>}\n   * A Promise resolving to object with ProductsKinds and TotalBalance.\n   */\n  const getProducts = () =>\n    bbStorage.getItem(bbStorageKeys.PRODUCT_SUMMARY)\n    .then(data => (\n      FROM_STORAGE && data\n      ? data\n      : loadProducts()\n    ));\n\n  /**\n   * @name analysisCategoryModel#getProductsArray\n   * @type {function}\n   *\n   * @description\n   * Get products.\n   *\n   * @param {boolean} keepEmptyProducts defines if empty product kinds should be passed.\n   *\n   * @returns {Promise.<module:model-bb-product-summary-ng.Product[], module:lib-bb-model-errors.ModelError>}\n   * A Promise resolving to array with Products.\n   */\n  const getProductsArray = (keepEmptyProducts = false) =>\n    getProducts()\n    .then(data => Object.keys(data)\n      .filter(kind => keepEmptyProducts || productKindHasProducts(data[kind]))\n      .reduce((products, kind) => {\n        const extendedProducts = data[kind].products\n          .map(product => Object.assign(product, { kind }));\n        return products.concat(extendedProducts);\n      }, [])\n    );\n\n  /**\n   * @name analysisCategoryModel#getProductByID\n   * @inner\n   * @type {function}\n   *\n   * @description\n   * Retrieves a product object with an ID provided\n   *\n   * @param {string} productId product ID to get a stored product record\n   *\n   * @returns {Promise.<module:model-bb-product-summary-ng.Product, module:lib-bb-model-errors.ModelError>}\n   * A Promise resolving to object with ProductsKinds and TotalBalance.\n   */\n  const getProductByID = (productId) => getProductsArray()\n    .then(products => {\n      const defaultProduct = GET_FIRST_AS_DEFAULT && products[0]\n        ? products[0]\n        : null;\n      return productId\n        ? products.find(product => product.id === productId)\n        : defaultProduct;\n    });\n\n  /**\n   * @name analysisCategoryModel#getProductsFromList\n   * @inner\n   * @type {function}\n   *\n   * @description\n   * Get products from list\n   *\n   * @param {string[]} ids Product ID array\n   * @returns {Promise.<module:model-bb-product-summary-ng.Product[], module:lib-bb-model-errors.ModelError>}\n   * A Promise resolving to an array with Products or null\n   */\n  const getProductsFromList = (ids) => getProductsArray()\n    .then(products => {\n      const defaultProduct = [];\n      if (GET_FIRST_AS_DEFAULT && products[0]) {\n        defaultProduct.push(products[0]);\n      }\n\n      if (!ids || !ids.length) {\n        return defaultProduct;\n      }\n\n      return ids.map(id => products.find(product => product.id === id) || defaultProduct);\n    });\n\n  /**\n   * @name analysisCategoryModel#getSelectedProduct\n   * @type {function}\n   *\n   * @description\n   * Get current selected product.\n   *\n   * @returns {Promise.<module:model-bb-product-summary-ng.Product, module:lib-bb-model-errors.ModelError>}\n   * A Promise resolving to a selected product object.\n   */\n  const getSelectedProduct = () => bbStorage.getItem(bbStorageKeys.PRODUCT_SELECTED)\n    .then(id => getProductByID(id));\n\n  /**\n   * @name analysisCategoryModel#getSelectedProducts\n   * @type {function}\n   *\n   * @description\n   * Get currently selected products array\n   *\n   * @returns {Promise.<module:model-bb-product-summary-ng.Product[], module:lib-bb-model-errors.ModelError>}\n   * A Promise resolving to Product array\n   */\n  const getSelectedProducts = () => bbStorage.getItem(bbStorageKeys.PRODUCTS_SELECTED)\n    .then(ids => getProductsFromList(ids));\n\n  /**\n   * @name analysisCategoryModel#setSelectedProduct\n   * @type {function}\n   *\n   * @description\n   * Set selected product to the sorage\n   *\n   * @param {module:model-bb-product-summary-ng.Product} selectedProduct The selected product value\n   */\n  const setSelectedProduct = (selectedProduct) => {\n    if (selectedProduct) {\n      bbStorage.setItem(bbStorageKeys.PRODUCT_SELECTED, selectedProduct.id);\n    } else {\n      bbStorage.removeItem(bbStorageKeys.PRODUCT_SELECTED);\n    }\n  };\n\n  /**\n   * @name analysisCategoryModel#setSelectedProducts\n   * @type {function}\n   *\n   * @description\n   * Set currently selected products array\n   *\n   * @param {module:model-bb-product-summary-ng.Product[]} products Array of products to select\n   */\n  const setSelectedProducts = (products) => {\n    if (products && products.length) {\n      bbStorage.setItem(bbStorageKeys.PRODUCTS_SELECTED,\n        products.map(product => product.id).filter(id => id)\n      );\n    } else {\n      bbStorage.removeItem(bbStorageKeys.PRODUCTS_SELECTED);\n    }\n  };\n\n  /**\n   * @name analysisCategoryModel#transformToSeries\n   * @type {function}\n   *\n   * @description\n   * Transforms data into format suitable for chart UI components\n   *\n   * @param {AnalysisCategoryData} analysisCategoryData Income/Spending category data\n   * @returns {BBSeries} Data in format suitable for chart UI components\n   */\n  const transformToSeries = (analysisCategoryData) => {\n    analysisCategoryData.items.sort((a, b) => b.portion - a.portion);\n    return {\n      datasets: [{\n        data: analysisCategoryData.items\n          .map(item => item.portion),\n      }],\n      labels: analysisCategoryData.items\n        .map(item => item.category),\n    };\n  };\n\n  /**\n   * @name analysisCategoryModel#isFirstProductDefault\n   * @type {function}\n   *\n   * @description\n   * Defines if the first product is selected by default\n   *\n   * @returns {boolean} GET_FIRST_AS_DEFAULT\n   */\n  const isFirstProductDefault = () => GET_FIRST_AS_DEFAULT;\n\n  /**\n   * @name analysisCategoryModel#isMultipleAccount\n   * @type {function}\n   *\n   * @description\n   * Defines if the widget is combined with multiple account selector\n   *\n   * @returns {boolean} IS_MULTIPLE_ACCOUNTS\n   */\n  const isMultipleAccount = () => IS_MULTIPLE_ACCOUNTS;\n\n  /**\n   * @name analysisCategoryModel\n   * @type {Object}\n   */\n  return {\n    E_PARAMS,\n    validateAnalysisParameters,\n    loadAnalysisData,\n    getProducts,\n    getProductsArray,\n    getSelectedProduct,\n    getSelectedProducts,\n    setSelectedProduct,\n    setSelectedProducts,\n    transformToSeries,\n    isFirstProductDefault,\n    isMultipleAccount,\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./model-bb-income-spending-analysis-category-ng/scripts/income-spending-analysis-category.js","module.exports = __WEBPACK_EXTERNAL_MODULE_28__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-model-errors\"\n// module id = 28\n// module chunks = 3 4 6 7","/**\n * @name bbStorageKeys\n * @description\n * bbStorage keys enum\n * @type {object}\n */\nexport const bbStorageKeys = {\n  PRODUCT_SELECTED: 'bb.product.selected',\n  PRODUCTS_SELECTED: 'bb.products.selected',\n  PRODUCT_SUMMARY: 'bb.product.summary.data',\n};\n\n/**\n * @name preferencesKeys\n * @description\n * Preferences keys enum\n * @type {object}\n */\nexport const preferencesKeys = {\n  IS_FIRST_PRODUCT_DEFAULT: 'useFirstProductAsDefault',\n  IS_PRODUCTS_LIST_FROM_STORAGE: 'getProductsFromStorage',\n  IS_MULTIPLE_ACCOUNTS: 'multipleAccounts',\n};\n\n/**\n * @name E_PARAMS\n * @description\n * Additional model error in case required parameters are missing\n * @type {string}\n */\nexport const E_PARAMS = 'error.load.params';\n\n\n\n// WEBPACK FOOTER //\n// ./model-bb-income-spending-analysis-category-ng/scripts/constants.js"],"sourceRoot":""}