{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6******","webpack:///webpack/bootstrap 779b1f71a92f6bec7e36?1313******","webpack:///./ui-bb-message-ng/model.xml","webpack:///external \"vendor-bb-angular\"?a114","webpack:///./ui-bb-message-ng/scripts/index.js","webpack:///./ui-bb-message-ng/scripts/directive.js","webpack:///./ui-bb-message-ng/scripts/controller.js"],"names":["module","directive","controller","name","prepareTemplate","template","hasLink","preparedTemplate","replace","str","text","prepareElement","elem","linesLength","$window","isMultiline","wrapperTemplate","wrapper","html","children","content","eq","suffix","styles","getComputedStyle","lineHeight","parseFloat","getPropertyValue","addClass","css","truncateElement","offsetHeight","nodes","contents","lastNode","length","nodeText","clippedText","remove","data","uiBbMessageDirective","$compile","$timeout","restrict","scope","link","preventDefault","onLinkClick","visibleLinesLength","transclude","cachedElemWidth","offsetWidth","resizeRef","initContent","onResize","cancel","newElemWidth","addEventListener","$on","removeEventListener","controllerAs","uiBbMessageController","$scope","$ctrl","event","Object","assign"],"mappings":"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","file":"ui-bb-message-ng/scripts/ui-bb-message-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vendor-bb-angular\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"ui-bb-message-ng\", [\"vendor-bb-angular\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ui-bb-message-ng\"] = factory(require(\"vendor-bb-angular\"));\n\telse\n\t\troot[\"ui-bb-message-ng\"] = factory(root[\"vendor-bb-angular\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_36__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 779b1f71a92f6bec7e36","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ui-bb-message-ng/model.xml\n// module id = 0\n// module chunks = 7","module.exports = __WEBPACK_EXTERNAL_MODULE_36__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor-bb-angular\"\n// module id = 36\n// module chunks = 6 7 8 9 10 11 12","/**\n * @module ui-bb-message-ng\n *\n * @example\n * // In an extension:\n * // file: scripts/index.js\n * import uiBbMessageNgKey from 'ui-bb-message-ng';\n *\n * export const dependencyKeys = [\n *   uiBbMessageNgKey,\n * ];\n *\n * // file: templates/template.ng.html\n * <ui-bb-message\n *  on-link-click=\"$ctrl.someAction()\"\n *  template=\"item.message\"\n *  link=\"item.link\"\n *  preventDefault=\"true\"\n *  truncate-line=\"1\"/>\n */\nimport angular from 'vendor-bb-angular';\n\nimport uiBbMessageDirective from './directive';\nimport uiBbMessageController from './controller';\n\n/**\n * @description The angular module name\n * @name default\n * @type {string}\n */\nexport default angular.module('ui-bb-message-ng', [])\n  .directive('uiBbMessage', ['$compile', '$window', '$timeout', uiBbMessageDirective])\n  .controller('uiBbMessageController', ['$scope', uiBbMessageController])\n  .name;\n\n\n\n// WEBPACK FOOTER //\n// ./ui-bb-message-ng/scripts/index.js","/**\n * @name  prepareTemplate\n * @description Prepares message template by sanitizing tags and applying link if needs\n * @type {function}\n * @inner\n * @param  {string} template HTML template\n * @param  {boolean} hasLink True if the link should apply link\n *\n * @return {string}          Prepared message template\n */\nconst prepareTemplate = (template, hasLink) => {\n  let preparedTemplate = template.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\n  if (hasLink) {\n    preparedTemplate = preparedTemplate.replace(/\\{\\{(.+?)\\}\\}/g, (str, text) => (\n      `<a target=\"_blank\" href=\"{{link}}\" data-ng-click=\"$ctrl.onLinkClick($event)\">${text}</a>`\n    ));\n  }\n\n  return preparedTemplate;\n};\n\n/**\n * @name  prepareElement\n * @description Prepares element structure and base styles\n * @type {function}\n * @inner\n * @param  {object} elem        Angular element\n * @param  {number} linesLength Number of visible lines\n * @param  {object} $window     Window object\n *\n * @return {object}             Links to wrapper, content and suffix elements\n */\nconst prepareElement = (elem, linesLength, $window) => {\n  const isMultiline = linesLength > 1;\n  const wrapperTemplate = `<span><span></span>${isMultiline ? '<span>...</span>' : ''}</span>`;\n  const wrapper = elem.html(wrapperTemplate).children();\n  const content = wrapper.children().eq(0);\n  const suffix = isMultiline ? wrapper.children().eq(1) : null;\n\n  if (!!linesLength) {\n    const styles = $window.getComputedStyle(elem[0]);\n    const lineHeight = parseFloat(styles.getPropertyValue('line-height'));\n\n    elem\n      .addClass(isMultiline ? 'multiline-ellipsis' : 'ellipsis')\n      .css('height', isMultiline ? `${linesLength * lineHeight}px` : 'auto');\n  }\n\n  return { wrapper, content, suffix };\n};\n\n/**\n * @name  truncateElement\n * @description Applies truncating to message\n * @type {function}\n * @inner\n * @param  {object} elem Angular element\n * @param  {object} wrapper Link to wrapper element\n * @param  {object} content Link to content element\n * @param  {object} suffix Link to suffix element\n */\nconst truncateElement = (elem, wrapper, content, suffix) => {\n  while (wrapper[0].offsetHeight > elem[0].offsetHeight) {\n    const nodes = content.contents();\n    const lastNode = nodes.eq(nodes.length - 1);\n    const nodeText = lastNode.text();\n    const clippedText = nodeText.replace(/\\s*\\S*\\s*$/, '');\n\n    if (clippedText.length) {\n      lastNode.text(clippedText);\n    } else {\n      lastNode.remove();\n    }\n\n    content.data('is-truncated', true);\n  }\n\n  suffix.css('visibility', content.data('is-truncated') ? 'visible' : 'hidden');\n};\n\nconst uiBbMessageDirective = function uiBbMessageDirective($compile, $window, $timeout) {\n  return {\n    restrict: 'E',\n    scope: {\n      link: '<',\n      preventDefault: '=',\n      template: '<',\n      onLinkClick: '&',\n      visibleLinesLength: '<',\n    },\n    transclude: false,\n    link: (scope, elem) => {\n      const hasLink = !!(scope.link || scope.onLinkClick);\n      const template = prepareTemplate(scope.template, hasLink);\n      const { wrapper, content, suffix } = prepareElement(elem, scope.visibleLinesLength, $window);\n\n      let cachedElemWidth = elem[0].offsetWidth;\n      let resizeRef = null;\n\n      /**\n       * @name  initContent\n       * @description Init message content\n       * @type {function}\n       * @inner\n       */\n      const initContent = () => {\n        content.data('is-truncated', false);\n        content.html(template);\n        $compile(content.contents())(scope);\n      };\n\n      /**\n       * @name  onResize\n       * @description Applies when resize method fired\n       * @type {function}\n       * @inner\n       */\n      const onResize = () => {\n        $timeout.cancel(resizeRef);\n        resizeRef = $timeout(() => {\n          const newElemWidth = elem[0].offsetWidth;\n\n          if (newElemWidth !== cachedElemWidth) {\n            if (newElemWidth > cachedElemWidth) {\n              initContent();\n            }\n\n            cachedElemWidth = newElemWidth;\n            truncateElement(elem, wrapper, content, suffix);\n          }\n        }, 75);\n      };\n\n      initContent();\n\n      if (scope.visibleLinesLength > 1) {\n        truncateElement(elem, wrapper, content, suffix);\n\n        $window.addEventListener('resize', onResize);\n      }\n\n      scope.$on('$destroy', () => {\n        $window.removeEventListener('resize', onResize);\n      });\n    },\n    controller: 'uiBbMessageController',\n    controllerAs: '$ctrl',\n  };\n};\n\n/**\n * @name uiBbMessageDirective\n * @type {function}\n *\n * @property {string} message Message content\n * @property {string} link Link that will added in message instead of `{{ link }}`\n * @property {boolean} preventDefault true if need to prevent default event when click on link\n * @property {function} onLinkClick callback function when click on link\n * @property {number} visibleLinesLength Number of lines to be visible. If message has more lines it\n * will be truncated by ellipsis. If parameter is not set message will not be truncated.\n */\nexport default uiBbMessageDirective;\n\n\n\n// WEBPACK FOOTER //\n// ./ui-bb-message-ng/scripts/directive.js","const uiBbMessageController = function uiBbMessageController($scope) {\n  const $ctrl = this;\n\n  /**\n   * @description\n   * Call `onLinkClick` event that define in `ui-bb-message` directive if it is set and prevent\n   * default event if need.\n   *\n   * @name uiBbMessageController#onLinkClick\n   * @type {function}\n   * @param {object} event Event object\n   */\n  const onLinkClick = event => {\n    if ($scope.onLinkClick) {\n      $scope.onLinkClick();\n    }\n    if ($scope.preventDefault) {\n      event.preventDefault();\n    }\n  };\n\n  Object.assign($ctrl, {\n    onLinkClick,\n  });\n};\n\n/**\n * @name uiBbMessageController\n * @type {function}\n */\nexport default uiBbMessageController;\n\n\n\n// WEBPACK FOOTER //\n// ./ui-bb-message-ng/scripts/controller.js"],"sourceRoot":""}